services:
  monkey_agent:
    build: ./monkey_agent
    container_name: monkey_agent
    ports:
      - "5007:5007"
    environment:
      - ORCHESTRATOR_URL=http://apisix:9080/orchestrator/ask
      - MATS_ORCHESTRATOR_URL=http://apisix:9080/agent/mats/jobs
      - GCP_PROJECT_ID=vector-search-poc
      - GCLOUD_MCP_DOCKER_IMAGE=finopti-gcloud-mcp
      - GCLOUD_MOUNT_PATH=${HOME}/.config/gcloud:/root/.config/gcloud
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ~/.config/gcloud:/root/.config/gcloud:ro
    networks:
      - finopti-net

  monkey_ui:
    build: ./monkey_ui
    container_name: monkey_ui
    ports:
      - "8088:80"
    networks:
      - finopti-net
    depends_on:
      - monkey_agent

networks:
  finopti-net:
    external: true
